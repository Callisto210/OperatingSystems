<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by LibreOffice - see http://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">- no title specified</title><meta name="DCTERMS.title" content="" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.issued" content="2016-06-07T12:56:54.280823646" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.modified" content="2016-06-07T14:27:13.819147590" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.Heading_20_2 { font-size:115%; margin-bottom:0.0835in; margin-top:0.139in; font-family:Liberation Sans; writing-mode:page; font-weight:bold; }
	.P1 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P10 { font-size:115%; font-weight:bold; margin-bottom:0.0835in; margin-top:0.139in; font-family:Liberation Sans; writing-mode:page; }
	.P11 { font-size:115%; font-weight:bold; margin-bottom:0.0835in; margin-top:0.139in; font-family:Liberation Sans; writing-mode:page; }
	.P2 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P3 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P4 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P5 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P6 { font-size:12pt; line-height:100%; margin-bottom:0.0598in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P7 { font-size:12pt; line-height:100%; margin-bottom:0.0598in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P8 { font-size:12pt; line-height:100%; margin-bottom:0.0598in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.P9 { font-size:12pt; line-height:100%; margin-bottom:0.0598in; margin-top:0in; font-family:Liberation Serif; writing-mode:page; }
	.Bullet_20_Symbols { font-family:OpenSymbol; }
	<!-- ODF styles with no properties representable as CSS -->
	.T1 .T2 .T3  { }
	</style></head><body dir="ltr" style="max-width:8.2681in;margin-top:0.7874in; margin-bottom:0.7874in; margin-left:0.7874in; margin-right:0.7874in; "><h2 class="P10"><a id="a__Koncepcja"><span/></a>Koncepcja</h2><p class="P6">Projekt zakładał stworzenie modułu do jądra systemu Linux, który implementował funkcjonalność RAM dysku.</p><p class="P6">Funkcjonalność obejmowała:</p><ul><li><p class="P7" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:NaNcm;">•</span>Tworzenie RAM dysku<span class="odfLiEnd"/> </p></li><li><p class="P7" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:NaNcm;">•</span>Zapis do RAM dysku poprzez odpowiednie urządzenie w katalogu /dev<span class="odfLiEnd"/> </p></li><li><p class="P7" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:NaNcm;">•</span>Odczyt z RAM dysku poprzez odpowiednie urządzenie w katalogu /dev<span class="odfLiEnd"/> </p></li><li><p class="P7" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:NaNcm;">•</span>Zmiana rozmiaru RAM dysku poprzez odpowiedni plik w katalogu /proc<span class="odfLiEnd"/> </p></li><li><p class="P8" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:NaNcm;">•</span>Zamknięcie RAM dysku<span class="odfLiEnd"/> </p></li></ul><p class="P9"> </p><h2 class="Heading_20_2"><a id="a__Mechanizmy_systemowe"><span/></a>Mechanizmy systemowe</h2><p class="P2"><span class="T1">RAM dysk można implementować na dwa sposoby: jako urządzenie blokowe (dyski, napędy cd) u jako urządzenie znakowe. Przewaga implementacji RAM dysku jako urządzenia blokowego polega na tym, że na takim dysku, można założyć system plików i zamontować go, jednakże w pewnym momencie musimy zmyślić geometrię dysku. Implementacja jako urządzenie znakowe nie umożliwia montowania, jednakże ciągle można go wykorzystywać jako bardzo szybki plik tymczasowy.</span></p><p class="P1">Wszystko w Linuxie jest plikiem. Dostęp do RAM dysku odbywa się poprzez odpowiedni plik w katalogu /dev (może być też inny katalog w którym można utworzyć plik, jednak RAM dysk jest urządzeniem i w katalogu /dev jest jego miejsce).</p><p class="P1">Sterowanie tym urządzeniem (zmiana rozmiaru RAM dysku), odbywa się poprzez plik w katalogu /proc (tutaj nie mamy możliwości wyboru katalogu w którym znajduje się plik, gdyż jądro tworzy plik w tym katalogu).</p><p class="P1">W module musimy alokować pamięć dla naszego RAM dysku. Można to zrobić na wiele sposobów w zależności od potrzeb <span class="T2">możemy użyć rodzinę funkcji typu kmalloc(), kmalloc_array() dla rozmiaru obszaru przekraczającego jedną stronę. Adres zwracany przez tą funkcję jest adresem fizycznym, a nie wirtualnym jak jak to ma miejsce w programach w przestrzeni użytkownika. Mając adres fizyczny, można do transportu danych wykorzystać układ DMA (np. do wysłania danych przez socket). Jednakże jądro Linuxa także zawiera przestrzeń adresową wirtualną, (dzięki wykorzystaniu mechanizmu MMU), lecz taka pamięć nie jest fizycznie ciągła, a co za tym idzie nie ma możliwości wykorzystywania układu DMA do transportu danych, ale łatwiej systemowi jest zająć pamięć we fragmentach, niż jeden spójny fragment w pamięci fizycznej.</span></p><p class="P3">Do projektu został wybrany kmalloc().</p><p class="P5"> </p><p class="P5"> </p><p class="P5"> </p><h2 class="P11"><a id="a__Opis_uruchomienia"><span/></a>Opis uruchomienia</h2><p class="P4">Po skompilowaniu projektu komendą 'make', moduł należy załadować do jądra systemu komendą 'insmod', która jako argument przyjmuje plik „kernel object” z rozszerzeniem .ko Po tej operacji mamy załadowany moduł. Możemy znaleźć jego symbole (odpowiednik programu nm) w pliku /proc/kallsyms. Wywołując komendę 'dmesg', możemy zobaczyć komunikaty wysyłane przez jądro systemu, m.in. przez nasz moduł, który informuje, że żeby uzyskać dostęp do modułu należy stworzyć plik urządzenia znakowego z opcją 'c', odpowiednią wartością major i minor, korzystając  z polecenia 'mknod'. Po tych operacjach możemy swobodnie pracować na pliku utworzonym przez komendę 'mknod', jeśli chcemy zmienić rozmiar pliku, wystarczy wpisać odpowiednią liczbę do pliku /proc/ramdisk_size , a gdy chcemy odczytać aktualny rozmiar wystarczy wywołać 'cat /proc/ramdisk_size'. <span class="T3">Po zakończeniu zabawy sprzątamy po sobie wywołując 'rmmod ramdisk'.</span></p></body></html>